@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  color-scheme: light;
  --bg-base: #f7f1e6;
  --bg-mint: #e7f2ea;
  --ink: #1f1a15;
  --ink-muted: #4c4237;
  --ink-soft: #6b6056;
  --accent: #f17b5b;
  --accent-2: #0f8a7a;
  --accent-3: #e3b34f;
  --surface: rgba(255, 255, 255, 0.78);
  --surface-strong: rgba(255, 255, 255, 0.92);
  --stroke: rgba(31, 27, 21, 0.14);
  --stroke-strong: rgba(31, 27, 21, 0.22);
  --shadow-soft: 0 16px 40px rgba(40, 28, 20, 0.14);
  --shadow-strong: 0 28px 80px rgba(40, 28, 20, 0.18);
}

html, body, #root { height: 100%; }

body {
  margin: 0;
  font-family: "Cairo", "Changa", system-ui, sans-serif;
  background: var(--bg-base);
  color: var(--ink);
}

.text-ink { color: var(--ink); }
.text-ink-muted { color: var(--ink-muted); }
.text-ink-soft { color: var(--ink-soft); }
.border-ink { border-color: var(--stroke); }
.border-ink-strong { border-color: var(--stroke-strong); }

.leaflet-container { font-family: "Cairo", "Changa", system-ui, sans-serif; }
.leaflet-control-container .leaflet-control { filter: drop-shadow(0 10px 25px rgba(40, 28, 20, 0.18)); }

.leaflet-popup-content-wrapper {
  background: var(--surface-strong);
  color: var(--ink);
  border: 1px solid var(--stroke);
  border-radius: 16px;
  box-shadow: 0 20px 70px rgba(40, 28, 20, 0.18);
}
.leaflet-popup-tip { background: var(--surface-strong); }

.glass {
  background: var(--surface);
  border: 1px solid var(--stroke);
  box-shadow: var(--shadow-soft);
  backdrop-filter: blur(12px);
}

.panel-muted {
  background: rgba(255, 255, 255, 0.65);
  border: 1px solid var(--stroke);
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.6);
  backdrop-filter: blur(8px);
}

.input{
  width: 100%;
  padding: 10px 12px;
  border-radius: 16px;
  border: 1px solid var(--stroke);
  background: rgba(255, 255, 255, 0.85);
  color: var(--ink);
  outline: none;
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.65);
}
.input::placeholder{ color: var(--ink-soft); }
.input:focus{ border-color: rgba(15, 138, 122, 0.5); box-shadow: 0 0 0 3px rgba(15, 138, 122, 0.18); }

.btn {
  padding: 0.45rem 0.8rem;
  border-radius: 1.1rem;
  border: 1px solid var(--stroke-strong);
  background: rgba(255, 255, 255, 0.85);
  color: var(--ink);
  font-weight: 600;
  transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
  box-shadow: 0 10px 20px rgba(40, 28, 20, 0.12);
}
.btn:hover { background: rgba(255, 255, 255, 0.98); transform: translateY(-1px); }

.btn-strong {
  padding: 0.55rem 1rem;
  border-radius: 1.2rem;
  border: 1px solid rgba(241, 123, 91, 0.45);
  background: linear-gradient(135deg, var(--accent), var(--accent-3));
  color: #2a1b12;
  font-weight: 800;
  box-shadow: 0 14px 30px rgba(241, 123, 91, 0.28);
  transition: transform 0.2s ease, filter 0.2s ease;
}
.btn-strong:hover { transform: translateY(-1px); filter: brightness(1.02); }

.btn-active {
  background: rgba(241, 123, 91, 0.18);
  border-color: rgba(241, 123, 91, 0.45);
  box-shadow: 0 12px 24px rgba(241, 123, 91, 0.2);
}

.media-tab {
  flex: 1;
  border: 1px solid var(--stroke-strong);
  border-radius: 14px;
  background: rgba(255, 255, 255, 0.75);
  color: var(--ink);
  font-weight: 800;
  font-size: 0.8rem;
  padding: 0.45rem 0.6rem;
  transition: all 0.18s ease;
}
.media-tab.active {
  border-color: rgba(15, 138, 122, 0.45);
  background: rgba(15, 138, 122, 0.15);
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.5);
}
.media-tab:disabled {
  opacity: 0.45;
  cursor: not-allowed;
}

.media-stage {
  border: 1px solid var(--stroke);
  border-radius: 18px;
  overflow: hidden;
  background: rgba(255, 255, 255, 0.82);
  box-shadow: 0 16px 36px rgba(40, 28, 20, 0.14);
}

.media-thumbs {
  display: flex;
  gap: 8px;
  overflow-x: auto;
  padding-bottom: 2px;
}
.media-thumb {
  width: 58px;
  min-width: 58px;
  height: 44px;
  border-radius: 10px;
  overflow: hidden;
  border: 1px solid var(--stroke);
  opacity: 0.75;
  transition: transform 0.18s ease, opacity 0.18s ease, border-color 0.18s ease;
}
.media-thumb.active {
  opacity: 1;
  border-color: rgba(241, 123, 91, 0.55);
  transform: translateY(-1px);
}
.media-thumb:hover {
  opacity: 1;
}

.badge {
  padding: 0.2rem 0.55rem;
  border-radius: 999px;
  border: 1px solid rgba(15, 138, 122, 0.35);
  background: rgba(15, 138, 122, 0.12);
  color: var(--ink);
  font-size: 0.7rem;
  font-weight: 700;
}
.kbd {
  padding: 0.2rem 0.55rem;
  border-radius: 999px;
  border: 1px solid var(--stroke);
  background: rgba(255, 255, 255, 0.6);
  font-size: 0.7rem;
}

.focus-ring { outline: none; box-shadow: 0 0 0 3px rgba(15, 138, 122, 0.2); }
.panel-title { font-size: 0.72rem; font-weight: 800; letter-spacing: 0.08em; color: var(--ink-muted); }

.bg-aurora {
  background:
    radial-gradient(900px 500px at 10% 10%, rgba(241, 123, 91, 0.28), transparent 60%),
    radial-gradient(800px 520px at 90% 15%, rgba(15, 138, 122, 0.25), transparent 60%),
    radial-gradient(900px 620px at 50% 100%, rgba(227, 179, 79, 0.26), transparent 60%),
    linear-gradient(160deg, #f8f1e8, #e5f1ea 55%, #f9f3ea);
  background-size: 160% 160%;
}

.pattern-overlay {
  background-image: radial-gradient(rgba(31, 27, 22, 0.14) 1px, transparent 1px);
  background-size: 18px 18px;
  mask-image: radial-gradient(circle at 55% 40%, black 48%, transparent 80%);
  opacity: 0.4;
}

.glow-ring {
  position: absolute;
  inset: -44px;
  pointer-events: none;
  border-radius: 999px;
  background: radial-gradient(circle at 40% 40%, rgba(241, 123, 91, 0.25), transparent 58%);
  filter: blur(18px);
}

.gradient-stroke {
  border: 1px solid var(--stroke);
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.35);
}

.scanline::before {
  content: "";
  position: absolute;
  inset: -20%;
  background: linear-gradient(180deg, transparent, rgba(241, 123, 91, 0.2), transparent);
  transform: translateY(-120%);
  animation: scan 3.6s ease-in-out infinite;
  pointer-events: none;
}
@keyframes scan { 0% { transform: translateY(-120%); } 100% { transform: translateY(120%); } }

*::-webkit-scrollbar { width: 10px; height: 10px; }
*::-webkit-scrollbar-thumb { background: rgba(15, 138, 122, 0.25); border-radius: 999px; border: 2px solid rgba(255, 255, 255, 0.6); }
*::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.35); }

/* Animated emoji markers */
.kids-marker { background: transparent !important; border: none !important; }
.kids-pin {
  width: 62px; height: 62px;
  border-radius: 26px;
  display: grid; place-items: center;
  border: 1px solid rgba(15, 138, 122, 0.3);
  background: rgba(255, 255, 255, 0.92);
  box-shadow: 0 18px 50px rgba(40, 28, 20, 0.2), inset 0 0 0 1px rgba(255, 255, 255, 0.6);
  backdrop-filter: blur(10px);
  transform-origin: 50% 100%;
  animation: markerBob 2.6s ease-in-out infinite;
  position: relative;
}
.kids-pin.active { animation: markerPop 0.45s ease-out 1, markerBob 2.2s ease-in-out infinite; }
.kids-pin .emoji { font-size: 22px; filter: drop-shadow(0 10px 18px rgba(40, 28, 20, 0.25)); }

.kids-pin .pulse{
  position:absolute;
  inset:-8px;
  border-radius: 999px;
  border: 1px solid rgba(15, 138, 122, 0.45);
  opacity: 0.25;
  animation: ringPulse 2.1s ease-in-out infinite;
  pointer-events:none;
}
.kids-pin .halo{
  position:absolute;
  inset:-18px;
  border-radius: 999px;
  background: radial-gradient(circle, rgba(15, 138, 122, 0.22), transparent 62%);
  filter: blur(14px);
  opacity: 0.55;
  animation: haloBreath 2.6s ease-in-out infinite;
  pointer-events:none;
}
@keyframes ringPulse{ 0%,100%{ transform: scale(0.98); opacity:0.22 } 50%{ transform: scale(1.05); opacity:0.38 } }
@keyframes haloBreath{ 0%,100%{ transform: scale(0.96); opacity:0.45 } 50%{ transform: scale(1.06); opacity:0.65 } }

.kids-pin::after {
  content:"";
  position:absolute;
  width: 76px; height: 76px;
  border-radius: 999px;
  background: radial-gradient(circle, rgba(241, 123, 91, 0.2), transparent 60%);
  filter: blur(10px);
  opacity: 0.55;
  animation: markerPulse 1.8s ease-in-out infinite;
  pointer-events:none;
}
@keyframes markerBob { 0%,100%{ transform: translateY(0) } 50%{ transform: translateY(-8px) } }
@keyframes markerPulse { 0%,100%{ transform: scale(0.92); opacity: 0.35 } 50%{ transform: scale(1.08); opacity: 0.85 } }
@keyframes markerPop { 0%{ transform: translateY(0) scale(0.92) } 60%{ transform: translateY(-10px) scale(1.1) } 100%{ transform: translateY(0) scale(1) } }

.leaflet-tooltip{
  background: rgba(255, 255, 255, 0.92);
  color: var(--ink);
  border: 1px solid var(--stroke);
  border-radius: 12px;
  padding: 6px 8px;
  box-shadow: 0 18px 50px rgba(40, 28, 20, 0.18);
  backdrop-filter: blur(10px);
}
.leaflet-tooltip-top:before{ border-top-color: var(--stroke) !important; }

/* Auto-draw animation for paths */
.dash-anim{
  stroke: rgba(15, 138, 122, 0.95);
  stroke-dasharray: 10 10;
  animation: dashMove 1.2s linear infinite;
  stroke-width: 4;
  opacity: 0.9;
}
@keyframes dashMove{ to { stroke-dashoffset: -20; } }

.map-note-bubble{
  padding: 8px 10px;
  border-radius: 16px;
  border: 1px solid var(--stroke);
  background: rgba(255, 255, 255, 0.92);
  color: var(--ink);
  font-size: 12px;
  font-weight: 900;
  box-shadow: 0 18px 50px rgba(40, 28, 20, 0.18);
  backdrop-filter: blur(10px);
  transform: translateY(-6px);
  animation: noteFloat 2.6s ease-in-out infinite;
  white-space: nowrap;
}
@keyframes noteFloat{
  0%,100%{ transform: translateY(-6px) }
  50%{ transform: translateY(-10px) }
}

.dash-anim-fill{
  stroke: rgba(241, 123, 91, 0.95);
  stroke-dasharray: 12 10;
  animation: dashMove 1.1s linear infinite;
  stroke-width: 4;
  opacity: 0.95;
  fill: rgba(241, 123, 91, 0.12);
}

.shadow-soft{ box-shadow: var(--shadow-soft); }

.map-frame{
  box-shadow: var(--shadow-strong);
  border: 1px solid var(--stroke-strong);
  background: rgba(255, 255, 255, 0.45);
  isolation: isolate;
}
.map-frame::after{
  content:"";
  position:absolute;
  inset: 0;
  pointer-events:none;
  background:
    radial-gradient(640px 260px at 12% -4%, rgba(241, 123, 91, 0.2), transparent 62%),
    radial-gradient(680px 260px at 88% 108%, rgba(15, 138, 122, 0.2), transparent 64%);
  z-index: 1;
}
.map-beams{
  position:absolute; inset:-40%;
  background:
    radial-gradient(closest-side at 20% 30%, rgba(241, 123, 91, 0.12), transparent 62%),
    radial-gradient(closest-side at 80% 20%, rgba(15, 138, 122, 0.12), transparent 60%),
    linear-gradient(120deg, transparent, rgba(241, 123, 91, 0.08), transparent);
  transform: rotate(12deg);
  animation: beamsMove 7s ease-in-out infinite;
  pointer-events:none;
  mix-blend-mode: multiply;
  opacity: 0.9;
}
@keyframes beamsMove{
  0%,100%{ transform: rotate(12deg) translate3d(-2%, -4%, 0); opacity:0.7 }
  50%{ transform: rotate(12deg) translate3d(3%, 4%, 0); opacity:1 }
}
.map-grain{
  position:absolute; inset:0;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='120' height='120' filter='url(%23n)' opacity='.12'/%3E%3C/svg%3E");
  opacity: .25;
  mix-blend-mode: multiply;
  pointer-events:none;
}
.map-corners{
  position:absolute; inset:10px;
  border-radius: 22px;
  border: 1px dashed var(--stroke);
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.4);
  pointer-events:none;
  opacity: .9;
}

.kid-pill{
  border: 1px solid rgba(241, 123, 91, 0.35);
  background: rgba(255, 255, 255, 0.88);
  color: var(--ink);
  border-radius: 999px;
  padding: 0.35rem 0.8rem;
  font-size: 0.74rem;
  font-weight: 800;
  box-shadow: 0 12px 24px rgba(40, 28, 20, 0.14);
  backdrop-filter: blur(10px);
}

.dash-glow{
  filter: drop-shadow(0 12px 22px rgba(241, 123, 91, 0.18));
}
.leaflet-interactive.dash-anim,
.leaflet-interactive.dash-anim-fill{
  filter: drop-shadow(0 18px 40px rgba(40, 28, 20, 0.22)) drop-shadow(0 0 10px rgba(241, 123, 91, 0.18));
}

.map-focus-ring{
  stroke: rgba(15, 138, 122, 0.9);
  stroke-width: 3;
  fill: rgba(15, 138, 122, 0.2);
  animation: focusPulse 1.9s ease-in-out infinite;
}
.map-focus-wave{
  stroke: rgba(241, 123, 91, 0.6);
  stroke-width: 2;
  fill: rgba(241, 123, 91, 0.1);
  stroke-dasharray: 10 10;
  animation: focusWave 2.6s ease-in-out infinite;
}
@keyframes focusPulse{ 0%,100%{ opacity:0.7 } 50%{ opacity:1 } }
@keyframes focusWave{ 0%,100%{ opacity:0.35 } 50%{ opacity:0.7 } }

.bubble-user{
  background: rgba(15, 138, 122, 0.16);
  border: 1px solid rgba(15, 138, 122, 0.3);
  color: var(--ink);
}
.bubble-bot{
  background: rgba(255, 255, 255, 0.85);
  border: 1px solid var(--stroke);
  color: var(--ink);
}
.bubble-typing{
  background: rgba(255, 255, 255, 0.7);
  border: 1px solid var(--stroke);
  color: var(--ink-muted);
}

.spark{
  position:absolute;
  font-size: 12px;
  opacity: 0.0;
  animation: sparkle 1.8s ease-in-out infinite;
  filter: drop-shadow(0 10px 20px rgba(40, 28, 20, 0.25));
  pointer-events:none;
  color: rgba(241, 123, 91, 0.9);
}
.spark.s1{ top: 4px; left: 10px; animation-delay: .0s; }
.spark.s2{ top: 10px; right: 10px; animation-delay: .35s; }
.spark.s3{ bottom: 8px; left: 24px; animation-delay: .65s; }
@keyframes sparkle{
  0%{ transform: translateY(0) scale(.75) rotate(0deg); opacity:0 }
  25%{ opacity:.95 }
  50%{ transform: translateY(-10px) scale(1.2) rotate(18deg); opacity:.75 }
  100%{ transform: translateY(-18px) scale(.65) rotate(30deg); opacity:0 }
}

/* Animated Map Character */
.map-character {
  font-size: 28px;
  display: inline-block;
  animation: mapBounce 2.4s ease-in-out infinite;
  filter: drop-shadow(0 8px 16px rgba(241, 123, 91, 0.3));
  position: relative;
}
.map-character::after {
  content: '';
  position: absolute;
  inset: -6px;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(15, 138, 122, 0.25), transparent 70%);
  animation: mapGlow 2.4s ease-in-out infinite;
  z-index: -1;
  filter: blur(8px);
}
@keyframes mapBounce {
  0%, 100% { transform: translateY(0) rotate(-2deg); }
  50% { transform: translateY(-6px) rotate(2deg); }
}
@keyframes mapGlow {
  0%, 100% { opacity: 0.4; transform: scale(0.95); }
  50% { opacity: 0.8; transform: scale(1.1); }
}
